version: 1.0

collector:
  id: "aws-collector-prod-01"
  mode: "full-sync"  # or "event-only"
  full_sync_interval: "24h"
  event_poll_interval: "30s"
  max_concurrent_collections: 5
  rate_limit:
    requests_per_second: 10
    burst_size: 20

aws:
  enabled: true
  regions:
    - us-east-1
    - us-west-2
    - eu-west-1
  accounts:
    - id: "123456789012"
      role_arn: "arn:aws:iam::123456789012:role/SecuRizonCollector"
      external_id: "securazion-external"
  features:
    ec2: true
    s3: true
    iam: true
    vpc: true
    lambda: true
    rds: true
    cloudtrail: true
    config: true
    guardduty: true

azure:
  enabled: false
  # tenant_id: ""
  # subscription_ids: []
  # client_id: ""
  # features:
  #   vms: true
  #   sql: true
  #   keyvault: true

gcp:
  enabled: false
  # project_ids: []
  # features:
  #   compute: true
  #   gcs: true
  #   bigquery: true

saas:
  enabled: true
  github:
    enabled: true
    organizations:
      - "securazion"
    scopes:
      - "repo"
      - "org:read"
  # slack:
  #   enabled: false
  #   workspace_token: ""
  # jira:
  #   enabled: false
  #   instance_url: ""

kafka:
  bootstrap_servers:
    - "kafka-1:9092"
    - "kafka-2:9092"
    - "kafka-3:9092"
  client_id: "securazion-collector"
  compression_type: "snappy"
  security:
    sasl_mechanism: "SCRAM-SHA-512"
    sasl_username: "securazion"
    sasl_password: "${KAFKA_PASSWORD}"
    ssl_enabled: true
    ssl_ca_cert_path: "/etc/ssl/certs/kafka-ca.crt"

neo4j:
  uri: "bolt://neo4j:7687"
  username: "neo4j"
  password: "${NEO4J_PASSWORD}"
  max_connection_pool_size: 50
  encryption: true
  trust_strategy: "TRUST_ALL_CERTIFICATES"

risk:
  weights:
    exposure: 1.2
    environment: 1.0
    threat_intel: 1.5
    data_sensitivity: 1.3
  thresholds:
    critical: 80
    high: 60
    medium: 40
    low: 20
  recalculation_interval: "6h"

policies:
  paths:
    - "/etc/securazion/policies/built-in"
    - "/etc/securazion/policies/custom"
  auto_remediate: false
  require_approval: true
  evaluation_timeout: "30s"

api:
  port: 8080
  host: "0.0.0.0"
  tls:
    enabled: false
    cert_file: "/etc/securazion/tls/cert.pem"
    key_file: "/etc/securazion/tls/key.pem"
  auth:
    enabled: true
    jwk_url: "https://auth.securazion.com/.well-known/jwks.json"
    audience: "securazion-api"
    token_ttl: "1h"
  rate_limit:
    requests_per_minute: 100
    burst_size: 20
  cors:
    enabled: true
    allowed_origins:
      - "https://securazion.com"
      - "https://app.securazion.com"

logging:
  level: "info"  # debug, info, warn, error
  format: "json"  # json, text
  output: "stdout"  # stdout, file, both
  file:
    path: "/var/log/securazion/collector.log"
    max_size: "100MB"
    max_backups: 10
    max_age: "30d"

metrics:
  enabled: true
  port: 9090
  path: "/metrics"
  push_enabled: true
  push_gateway: "metrics.securazion.com:9091"
  push_interval: "15s"

health:
  enabled: true
  port: 8081
  path: "/health"
  readiness_path: "/ready"
  liveness_path: "/live"

tracing:
  enabled: false
  jaeger:
    endpoint: "http://jaeger:14268/api/traces"
    sampler:
      type: "probabilistic"
      param: 0.1

feature_flags:
  attack_path_analysis: true
  real_time_correlation: true
  automated_remediation: false
  threat_intelligence_integration: true
